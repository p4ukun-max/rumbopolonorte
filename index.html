<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Rumbo al Polo Norte</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #061526;
  font-family: system-ui, sans-serif;
}
canvas { display: block; }

/* ===== MEN√ö INICIO ===== */
#startMenu {
  position: fixed;
  inset: 0;
  background:
    radial-gradient(circle at top, #0b4d2c, #061526 60%),
    linear-gradient(#061526, #021018);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 10;
  color: white;
  overflow: hidden;
}

/* LUCES */
#startMenu::before {
  content: "";
  position: absolute;
  top: 20px;
  left: -5%;
  width: 110%;
  height: 80px;
  background-repeat: repeat-x;
  background-size: 60px 60px;
  background-image:
    radial-gradient(circle, red 30%, transparent 31%),
    radial-gradient(circle, gold 30%, transparent 31%),
    radial-gradient(circle, lime 30%, transparent 31%),
    radial-gradient(circle, cyan 30%, transparent 31%);
  background-position: 0 0, 15px 0, 30px 0, 45px 0;
  animation: blinkLights 1.8s infinite alternate;
}

@keyframes blinkLights {
  from { opacity: .6; }
  to { opacity: 1; }
}

/* T√çTULO */
#startMenu h1 {
  font-size: 40px;
  margin-bottom: 30px;
  text-shadow: 0 0 15px #7fffd4;
}

/* ===== SELECTOR SANTA ===== */
#santaSelector {
  text-align: center;
  margin-bottom: 35px;
}

#santaSelector p {
  margin-bottom: 12px;
  font-size: 18px;
}

.santaOptions {
  display: flex;
  gap: 18px;
}

.santaOptions img {
  width: 70px;
  cursor: pointer;
  padding: 6px;
  border-radius: 16px;
  background: rgba(255,255,255,.12);
  transition: transform .2s, box-shadow .2s, background .2s;
}

.santaOptions img:hover {
  transform: scale(1.1);
}

.santaOptions img.selected {
  background: rgba(255,255,255,.9);
  box-shadow: 0 0 25px #7fffd4;
}

/* BOT√ìN */
#startBtn {
  font-size: 24px;
  padding: 18px 42px;
  border-radius: 40px;
  border: none;
  cursor: pointer;
  background: linear-gradient(135deg, #ffffff, #d4faff);
  color: #06321f;
  box-shadow: 0 0 25px #7fffd4;
  transition: transform .2s;
}

#startBtn:hover {
  transform: scale(1.08);
}
</style>
</head>

<body>

<div id="startMenu">
  <h1>Rumbo al Polo Norte</h1>

  <div id="santaSelector">
    <p>Elige tu Santa üéÖ</p>
    <div class="santaOptions">
      <img data-santa="0">
      <img data-santa="1">
      <img data-santa="2">
      <img data-santa="3">
    </div>
  </div>

  <button id="startBtn">Iniciar Juego</button>
</div>

<canvas id="game"></canvas>

<script>
/* ================= CANVAS ================= */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let screenW, screenH, scale;
let gravity = 0, lift = 0, speed = 0;
let SANTA_SCALE = 0.20;

function resize(){
  const dpr = devicePixelRatio || 1;
  screenW = innerWidth;
  screenH = innerHeight;
  canvas.width = screenW * dpr;
  canvas.height = screenH * dpr;
  canvas.style.width = screenW + "px";
  canvas.style.height = screenH + "px";
  ctx.setTransform(dpr,0,0,dpr,0,0);

  scale = Math.min(screenW / 360, 1.2);
  SANTA_SCALE = 0.12 * scale;
  gravity = 0.45 * scale;
  lift = -8 * scale;
  speed = 3 * scale;
}
resize();
addEventListener("resize", resize);

/* ================= AUDIO ================= */
let snd = null, audioUnlocked = false;
const sndHit = new Audio("https://assets.mixkit.co/active_storage/sfx/1109/1109-preview.mp3");

function startAudio(){
  if(audioUnlocked) return;
  snd = new Audio("christmas.mp3");
  snd.loop = true;
  snd.volume = .3;
  snd.play().then(()=>audioUnlocked=true).catch(()=>{});
}

/* ================= IM√ÅGENES ================= */
const santaImg = new Image();
const icebergImg = new Image();
const finalImg = new Image();

/* üëâ CAMBIA ESTAS URLS */
const santaImages = [
  "URL_SANTA_1.png",
  "URL_SANTA_2.png",
  "URL_SANTA_3.png",
  "URL_SANTA_4.png"
];

let selectedSanta = 0;
santaImg.src = santaImages[selectedSanta];

icebergImg.src = "https://www.dropbox.com/scl/fi/t0jk7vrotgrykx912v5le/hielo.png?dl=1";
finalImg.src   = "https://www.dropbox.com/scl/fi/jc6y5ao7snuzqtrbrq4cb/noel.png?dl=1";

/* ================= JUEGO ================= */
const santa = { x:60, y:0, w:0, h:0, vel:0 };
let pipes=[], gifts=[];
let started=false, finished=false;
let count=0, interval=null;

/* ================= AURORA ================= */
let auroraT = 0;
function drawAurora(){
  auroraT += 0.01;
  const h = screenH * 0.35;
  ctx.fillStyle="rgba(80,255,180,.25)";
  ctx.beginPath();
  ctx.moveTo(0,0);
  for(let x=0;x<=screenW;x+=8){
    ctx.lineTo(x, h*0.4 + Math.sin(x*0.01+auroraT)*30);
  }
  ctx.lineTo(screenW,0);
  ctx.fill();
}

/* ================= ICEBERGS ================= */
function createIceberg(){
  if(count>=3){
    finished=true;
    clearInterval(interval);
    interval=setInterval(dropGift,250);
    return;
  }
  const gap=240*scale;
  const top=Math.random()*(screenH-gap-160*scale)+80*scale;
  pipes.push({x:screenW,w:80*scale,top,bottom:top+gap});
  count++;
}

function dropGift(){
  gifts.push({
    x:santa.x+santa.w/2,
    y:santa.y+santa.h,
    v:2+Math.random()*2
  });
}

/* ================= UPDATE ================= */
function update(){
  if(!started) return;

  santa.vel+=gravity;
  santa.y+=santa.vel;

  pipes.forEach(p=>p.x-=speed);
  pipes=pipes.filter(p=>p.x+p.w>0);

  pipes.forEach(p=>{
    if(!finished &&
      santa.x+santa.w>p.x &&
      santa.x<p.x+p.w &&
      (santa.y<p.top || santa.y+santa.h>p.bottom)
    ){
      sndHit.play();
      resetGame();
    }
  });

  if(finished){
    gifts.forEach(g=>g.y+=g.v);
    gifts=gifts.filter(g=>g.y<screenH);
  }
}

function resetGame(){
  pipes=[];
  gifts=[];
  finished=false;
  count=0;
  santa.y=screenH/2;
  santa.vel=0;
  interval=setInterval(createIceberg,1800);
}

/* ================= DRAW ================= */
function draw(){
  ctx.fillStyle="#061526";
  ctx.fillRect(0,0,screenW,screenH);

  drawAurora();

  pipes.forEach(p=>{
    ctx.drawImage(icebergImg,p.x,p.bottom,p.w,screenH-p.bottom);
    ctx.save();
    ctx.translate(p.x,p.top);
    ctx.scale(1,-1);
    ctx.drawImage(icebergImg,0,0,p.w,p.top);
    ctx.restore();
  });

  santa.w=santaImg.naturalWidth*SANTA_SCALE;
  santa.h=santaImg.naturalHeight*SANTA_SCALE;
  ctx.drawImage(santaImg,santa.x,santa.y,santa.w,santa.h);

  if(finished){
    gifts.forEach(g=>{
      ctx.font=`${24*scale}px serif`;
      ctx.fillText("üéÅ",g.x,g.y);
    });
  }
}

/* ================= LOOP ================= */
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();

/* ================= INPUT ================= */
addEventListener("pointerdown",()=>{
  if(started) santa.vel=lift;
});

/* ================= SELECTOR ================= */
const santaOptions=document.querySelectorAll(".santaOptions img");
santaOptions.forEach((img,i)=>{
  img.src=santaImages[i];
  img.onclick=()=>{
    selectedSanta=i;
    santaImg.src=santaImages[i];
    santaOptions.forEach(o=>o.classList.remove("selected"));
    img.classList.add("selected");
  };
});
santaOptions[0].classList.add("selected");

/* ================= START ================= */
document.getElementById("startBtn").onclick=()=>{
  startAudio();
  document.getElementById("startMenu").style.display="none";
  started=true;
  santa.y=screenH/2;
  interval=setInterval(createIceberg,1800);
};
</script>
</body>
</html>
